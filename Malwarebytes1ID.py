# Importing required modules
import random
import hashlib
import time
from os import path
from os import system

# Setting console color and title
# Defining possible characters
system('color 3')
system("title "+'Malwarebytes Key Generator by @prombo')
digList = "0123456789ABCDEFGHJKLMNPQRTUVWXY"

print("""
███╗   ███╗ █████╗ ██╗     ██╗    ██╗ █████╗ ██████╗ ███████╗██████╗ ██╗   ██╗████████╗███████╗███████╗
████╗ ████║██╔══██╗██║     ██║    ██║██╔══██╗██╔══██╗██╔════╝██╔══██╗╚██╗ ██╔╝╚══██╔══╝██╔════╝██╔════╝
██╔████╔██║███████║██║     ██║ █╗ ██║███████║██████╔╝█████╗  ██████╔╝ ╚████╔╝    ██║   █████╗  ███████╗
██║╚██╔╝██║██╔══██║██║     ██║███╗██║██╔══██║██╔══██╗██╔══╝  ██╔══██╗  ╚██╔╝     ██║   ██╔══╝  ╚════██║
██║ ╚═╝ ██║██║  ██║███████╗╚███╔███╔╝██║  ██║██║  ██║███████╗██████╔╝   ██║      ██║   ███████╗███████║
╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝ ╚══╝╚══╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚═════╝    ╚═╝      ╚═╝   ╚══════╝╚══════╝
""")

amount = int(input("How many keys to generate : "))

# Generate random number
def randNum():
    num = random.randint(0,9)
    return(str(num))

# Generate random capital letter
def randLet():
    let = chr(random.randint(65,90))
    return(let)

# Generate malwarebytes 5 character ID
def IDGen():
    key = randNum() + randLet() + randLet() + randNum() + randNum()
    return(key)

# Create licence key based on ID
def KeyGen():
    i = 0
    keyID = IDGen()
    # Encode ID in MD5, digest in hex
    hashed = hashlib.md5(keyID.encode()).hexdigest()
    key = ""
    while i < 32:
        # Convert each 16 bit hex into binary. Perform bitwise AND against 31
        # Find character from digilist
        hexNum = hashed[i] + hashed[i+1]
        num = int(hexNum, 16) & 31
        if i % 8 == 0 and i > 0:
            # Add "-" every 4 cycles
            key = key + "-" + digList[num]
        else:
            key = key + digList[num]
        i += 2
    result = keyID + ":" + key
    return(result)

# Create new file if already exists
def File():
    name = "keys.txt"
    x = 1
    while path.exists(name):
        name = "keys(" + str(x) + ").txt"
        x = x + 1
    return name

f = open(File(),"w+")

# Write keys to file   
for i in range(amount):
    key = KeyGen()
    f.write(key + "\n")
    print(i," . ",key)
    time.sleep(0.0005)

f.close()
